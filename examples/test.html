<!DOCTYPE html>
<html lang="en">
    <head>
        <title>state.js v5.0.0 example</title>
    </head>
	<body>
        <h1>state.js v5.0.0 example</h1>
		<p>This example implements a simple controller for a cassette player according to the model below:</p>
		<p><img id="diagram" /></p>
		<p>Press the buttons below to send events to the controller (check brower console for trace output):</p>
		<button type="button">play</button>
		<button type="button">pause</button>
		<button type="button">stop</button>
		<button type="button" >flip</button>
		<button type="button" >off</button>
		<p id="head">Head: disengaged</p>
		<p id="motor">Motor: stopped</p>
    </body>

    <!-- jQuery -->
    <script src="jquery-1.11.2.min.js"></script>

    <!-- the state machine runtime -->
    <script src="../src/state.js"></script>

    <!-- the core player code -->
    <script src="player.js"></script>

    <!-- script to wire the core player to the web page -->
    <script>               
        /* initialise the page */
        $(document).ready(function() {				
            /* add core behaviour to appropriate states and transitions in the player machine*/
            active.entry(function () { $("#head").text("Head: engaged"); }).exit(function () { $("#head").text("Head: disengaged"); });
            running.entry(function () { $("#motor").text("Motor: running"); }).exit(function() { $("#motor").text("Motor: stopped"); });            

            /* add a little more behavior to states to adjust the graphic*/
            stopped.entry(function () { $("#diagram").attr("src", "controller_stopped.png"); });
            running.entry(function () { $("#diagram").attr("src", "controller_running.png"); });
            paused.entry(function () { $( "#diagram" ).attr("src", "controller_paused.png"); });
            finalState.entry(function () { $("#diagram").attr("src", "controller_final.png"); });
            flipped.entry(function () { $("#diagram").attr("src", "controller_flipped.png"); });            

            /* create the state machine context object */
            var sms = new FSM.Context();

            /* pass button values to the state machine when clicked */
            $("button").click(function(button) { player.evaluate(button.target.innerHTML, sms); });

            /* initialise the machine */
            player.initialise(sms)
        });
    </script>
</html>